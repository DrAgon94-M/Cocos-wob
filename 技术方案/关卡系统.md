## 需求

### 关卡

关卡的大体流程可以参考蔚蓝。

 ![蔚蓝关卡切换](关卡系统.assets/蔚蓝关卡切换.gif)



关卡由 **环境**、**机关**、**装饰**、**收集元素** 组成。

**环境**：地面和墙

**机关**：可以影响玩家或被玩家利用的东西，例如 **弹簧** 和 **尖刺**

**装饰**：光、背景墙、一些粒子效果、一些无碰撞体的模型。

**收集元素**：护符、金币。收集护符需要播放过场动画。



关卡分类：

按照节奏来分类：**舒缓节奏关卡**、**起伏节奏关卡**、**紧张节奏关卡**

按照体量来分类：**长关卡**、**短关卡**，短关卡的尺寸大概就是一个屏幕大小，长关卡则比一个屏幕大得多。

按照元素来分类：**跑酷关卡**、**解谜关卡**、**跑酷解迷关卡**



**「舒缓节奏」「短」关卡** 一般用作教学关卡，落脚点较多，节奏慢，不容易死亡。

**「紧张节奏」「短」关卡** 是最常见的关卡，落脚点较少，需要玩家连续的操作或在短时间内找到解谜的办法，死亡率较高。

**「起伏节奏」「长」关卡** 指关卡较长，但是往往在一段紧张节奏后有一个落脚点来缓和节奏，给玩家思考的时间。

**「紧张节奏」「长」关卡** 一般用于一个章节的最后一个关卡，一般为 boss 追逐战，全程没有落脚点，节奏十分紧张。



- **每次切换关卡**：
  - 将镜头移动到下个关卡离玩家最近的地方。
  - 刷新关卡内的所有机关。
- **出生点**：每个关卡的出口都有出生点，每次玩家移动到出生点则设置新的出生点。
- **镜头**：
  - 如果关卡已经是最小尺寸，则不需要移动。
  - 如果关卡大于最小尺寸，则需要将镜头的位置和玩家在关卡内的位置比例同步，有些关卡需要将镜头偏移。

- **演出**：在一些特殊的关卡需要播放过场动画来推进剧情。